<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">My Portfolio - Whitelabel Token Platform</title>
    
    <!-- Material-UI CSS -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-ui/4.12.4/material-ui.min.css" integrity="sha512-v6G9oLw5uQj8QfP7a4s5L5g5Wz5m5m5WcF5o7Y5l5N8x5t5v5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom CSS -->
    <style>
        :root {
            /* These colors will be dynamically replaced with client brand colors */
            --primary-color: #007AFF;
            --secondary-color: #5856D6;
            --accent-color: #BF953F;
            --background-color: #F8F9FA;
            --card-background: #FFFFFF;
            --text-primary: #212529;
            --text-secondary: #6C757D;
            --border-color: #E9ECEF;
            --gold-color: #FFD700;
            --silver-color: #C0C0C0;
            --platinum-color: #E5E4E2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo img {
            height: 40px;
            width: auto;
        }

        .company-name {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .balance-info {
            background: rgba(255,255,255,0.1);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 500;
        }

        .notification-bell {
            position: relative;
            cursor: pointer;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #FF4444;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            cursor: pointer;
        }

        .container {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            width: 280px;
            background: var(--card-background);
            border-right: 1px solid var(--border-color);
            padding: 2rem 0;
        }

        .sidebar nav ul {
            list-style: none;
        }

        .sidebar nav li {
            margin: 0;
        }

        .sidebar nav a {
            display: flex;
            align-items: center;
            padding: 0.75rem 2rem;
            text-decoration: none;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }

        .sidebar nav a:hover {
            background: var(--background-color);
            color: var(--primary-color);
            border-left: 3px solid var(--primary-color);
        }

        .sidebar nav a.active {
            background: var(--background-color);
            color: var(--primary-color);
            border-left: 3px solid var(--primary-color);
            font-weight: 500;
        }

        .sidebar nav .material-icons {
            margin-right: 0.75rem;
            font-size: 20px;
        }

        .main-content {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        .welcome-section {
            margin-bottom: 2rem;
        }

        .welcome-title {
            font-size: 2rem;
            font-weight: 300;
            color: var(--text-primary);
        }

        .welcome-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
        }

        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .asset-card {
            background: var(--card-background);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .asset-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }

        .asset-card.gold {
            border-top: 4px solid var(--gold-color);
        }

        .asset-card.silver {
            border-top: 4px solid var(--silver-color);
        }

        .asset-card.platinum {
            border-top: 4px solid var(--platinum-color);
        }

        .asset-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 1rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .asset-icon.gold {
            background: linear-gradient(135deg, #FFD700, #FFA500);
        }

        .asset-icon.silver {
            background: linear-gradient(135deg, #C0C0C0, #E5E5E5);
        }

        .asset-icon.platinum {
            background: linear-gradient(135deg, #E5E4E2, #F5F5F5);
        }

        .asset-name {
            font-size: 1.25rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .asset-symbol {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .asset-balance {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .asset-value {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .asset-change {
            font-size: 0.875rem;
            font-weight: 500;
            padding: 0.25rem 0.75rem;
            border-radius: 16px;
        }

        .asset-change.positive {
            background: #D4EDDA;
            color: #155724;
        }

        .asset-change.negative {
            background: #F8D7DA;
            color: #721C24;
        }

        .quick-actions {
            background: var(--card-background);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .quick-actions-title {
            font-size: 1.25rem;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .action-btn {
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .action-btn:hover {
            border-color: var(--primary-color);
            background: var(--background-color);
            transform: translateY(-2px);
        }

        .action-btn .material-icons {
            font-size: 2rem;
            color: var(--primary-color);
        }

        .action-label {
            font-weight: 500;
        }

        .market-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .market-card {
            background: var(--card-background);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .market-title {
            font-size: 1.25rem;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .price-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .price-item:last-child {
            border-bottom: none;
        }

        .price-label {
            font-weight: 500;
        }

        .price-value {
            font-weight: 600;
            color: var(--primary-color);
        }

        .price-change {
            font-size: 0.875rem;
            margin-left: 0.5rem;
        }

        .price-change.positive {
            color: #28A745;
        }

        .price-change.negative {
            color: #DC3545;
        }

        .recent-activity {
            background: var(--card-background);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .activity-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }

        .activity-title {
            font-size: 1.25rem;
            font-weight: 500;
        }

        .activity-item {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-content {
            flex: 1;
        }

        .activity-description {
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .activity-details {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .activity-time {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .activity-amount {
            font-weight: 600;
            color: var(--primary-color);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-1px);
        }

        .btn-success {
            background: #28A745;
            color: white;
        }

        .btn-danger {
            background: #DC3545;
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: var(--card-background);
            margin: 5% auto;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 500;
        }

        .close {
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 1rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border-color);
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .alert {
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
        }

        .alert-success {
            background: #D4EDDA;
            color: #155724;
            border: 1px solid #C3E6CB;
        }

        .alert-error {
            background: #F8D7DA;
            color: #721C24;
            border: 1px solid #F5C6CB;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }

            .company-name {
                font-size: 1.25rem;
            }

            .balance-info {
                display: none;
            }

            .sidebar {
                width: 100%;
                position: fixed;
                z-index: 1000;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                padding: 1rem;
            }

            .portfolio-grid {
                grid-template-columns: 1fr;
            }

            .market-info {
                grid-template-columns: 1fr;
            }

            .actions-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --background-color: #121212;
                --card-background: #1E1E1E;
                --text-primary: #FFFFFF;
                --text-secondary: #B3B3B3;
                --border-color: #333333;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <img id="companyLogo" src="" alt="Company Logo" style="display: none;">
            <span class="company-name" id="companyName">Loading...</span>
        </div>
        <div class="header-actions">
            <div class="balance-info">
                <span id="totalBalance">â‚¹0</span>
            </div>
            <div class="notification-bell" onclick="toggleNotifications()">
                <span class="material-icons">notifications</span>
                <span class="notification-badge" id="notificationBadge">3</span>
            </div>
            <div class="user-avatar" id="userAvatar" onclick="showUserMenu()">U</div>
        </div>
    </header>

    <div class="container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar" id="sidebar">
            <nav>
                <ul>
                    <li><a href="#" class="nav-link active" data-page="dashboard">
                        <span class="material-icons">dashboard</span>
                        Dashboard
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="portfolio">
                        <span class="material-icons">account_balance_wallet</span>
                        My Portfolio
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="buy">
                        <span class="material-icons">shopping_cart</span>
                        Buy Tokens
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="sell">
                        <span class="material-icons">sell</span>
                        Sell Tokens
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="transactions">
                        <span class="material-icons">receipt</span>
                        Transaction History
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="redemption">
                        <span class="material-icons">local_shipping</span>
                        Physical Redemption
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="security">
                        <span class="material-icons">security</span>
                        Security Center
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="support">
                        <span class="material-icons">help</span>
                        Help & Support
                    </a></li>
                    <li><a href="#" class="nav-link" data-page="profile">
                        <span class="material-icons">person</span>
                        Profile Settings
                    </a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Welcome Section -->
            <div class="welcome-section">
                <h1 class="welcome-title" id="welcomeTitle">Welcome back!</h1>
                <p class="welcome-subtitle" id="welcomeSubtitle">Here's your precious metals portfolio overview</p>
            </div>

            <!-- Alert Container -->
            <div id="alertContainer"></div>

            <!-- Portfolio Overview -->
            <div class="portfolio-grid" id="portfolioGrid">
                <div class="asset-card gold">
                    <div class="asset-icon gold">ðŸ¥‡</div>
                    <div class="asset-name">Gold</div>
                    <div class="asset-symbol">BGT Token</div>
                    <div class="asset-balance" id="goldBalance">0g</div>
                    <div class="asset-value" id="goldValue">â‚¹0</div>
                    <div class="asset-change positive" id="goldChange">+0.0%</div>
                </div>
                
                <div class="asset-card silver">
                    <div class="asset-icon silver">ðŸ¥ˆ</div>
                    <div class="asset-name">Silver</div>
                    <div class="asset-symbol">BST Token</div>
                    <div class="asset-balance" id="silverBalance">0g</div>
                    <div class="asset-value" id="silverValue">â‚¹0</div>
                    <div class="asset-change positive" id="silverChange">+0.0%</div>
                </div>
                
                <div class="asset-card platinum">
                    <div class="asset-icon platinum">ðŸ¥‰</div>
                    <div class="asset-name">Platinum</div>
                    <div class="asset-symbol">BPT Token</div>
                    <div class="asset-balance" id="platinumBalance">0g</div>
                    <div class="asset-value" id="platinumValue">â‚¹0</div>
                    <div class="asset-change positive" id="platinumChange">+0.0%</div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h3 class="quick-actions-title">Quick Actions</h3>
                <div class="actions-grid">
                    <button class="action-btn" onclick="openTradeModal('buy')">
                        <span class="material-icons">trending_up</span>
                        <span class="action-label">Buy Tokens</span>
                    </button>
                    <button class="action-btn" onclick="openTradeModal('sell')">
                        <span class="material-icons">trending_down</span>
                        <span class="action-label">Sell Tokens</span>
                    </button>
                    <button class="action-btn" onclick="openRedemptionModal()">
                        <span class="material-icons">local_shipping</span>
                        <span class="action-label">Redeem Physical</span>
                    </button>
                    <button class="action-btn" onclick="downloadCertificate()">
                        <span class="material-icons">description</span>
                        <span class="action-label">Download Certs</span>
                    </button>
                </div>
            </div>

            <!-- Market Information -->
            <div class="market-info">
                <div class="market-card">
                    <h3 class="market-title">Live Market Prices</h3>
                    <div class="price-item">
                        <span class="price-label">Gold (24K)</span>
                        <span>
                            <span class="price-value" id="goldPrice">â‚¹6,250/g</span>
                            <span class="price-change positive" id="goldChangePercent">+1.2%</span>
                        </span>
                    </div>
                    <div class="price-item">
                        <span class="price-label">Silver (999)</span>
                        <span>
                            <span class="price-value" id="silverPrice">â‚¹57/g</span>
                            <span class="price-change positive" id="silverChangePercent">+0.8%</span>
                        </span>
                    </div>
                    <div class="price-item">
                        <span class="price-label">Platinum (9995)</span>
                        <span>
                            <span class="price-value" id="platinumPrice">â‚¹1,230/g</span>
                            <span class="price-change positive" id="platinumChangePercent">+0.5%</span>
                        </span>
                    </div>
                    <div style="margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        Last updated: <span id="priceUpdateTime">2 mins ago</span>
                    </div>
                </div>

                <div class="market-card">
                    <h3 class="market-title">Portfolio Performance</h3>
                    <div class="price-item">
                        <span class="price-label">Today's Gain/Loss</span>
                        <span class="price-value" id="dailyChange">â‚¹+2,450</span>
                    </div>
                    <div class="price-item">
                        <span class="price-label">This Week</span>
                        <span class="price-value" id="weeklyChange">â‚¹+8,750</span>
                    </div>
                    <div class="price-item">
                        <span class="price-label">This Month</span>
                        <span class="price-value" id="monthlyChange">â‚¹+25,600</span>
                    </div>
                    <div class="price-item">
                        <span class="price-label">Total Return</span>
                        <span class="price-value" id="totalReturn">â‚¹+18.5%</span>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="recent-activity">
                <div class="activity-header">
                    <h3 class="activity-title">Recent Activity</h3>
                </div>
                <div id="activityList">
                    <div class="activity-item">
                        <div class="activity-content">
                            <div class="activity-description">Bought 2.5g Gold BGT</div>
                            <div class="activity-details">Transaction #TXN789123 | 2 hours ago</div>
                        </div>
                        <div class="activity-amount">â‚¹15,625</div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-content">
                            <div class="activity-description">Sold 100g Silver BST</div>
                            <div class="activity-details">Transaction #TXN789122 | 1 day ago</div>
                        </div>
                        <div class="activity-amount">â‚¹5,700</div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-content">
                            <div class="activity-description">Portfolio increased by +1.8%</div>
                            <div class="activity-details">Market movement | 2 days ago</div>
                        </div>
                        <div class="activity-amount">+â‚¹4,250</div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Trade Modal -->
    <div id="tradeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="tradeModalTitle">Buy Tokens</h2>
                <span class="close" onclick="closeTradeModal()">&times;</span>
            </div>
            <div class="trade-form">
                <div class="form-group">
                    <label class="form-label">Asset Type</label>
                    <select class="form-input" id="assetTypeSelect">
                        <option value="GOLD">Gold (BGT) - â‚¹6,250/g</option>
                        <option value="SILVER">Silver (BST) - â‚¹57/g</option>
                        <option value="PLATINUM">Platinum (BPT) - â‚¹1,230/g</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Quantity (grams)</label>
                    <input type="number" class="form-input" id="quantityInput" placeholder="Enter quantity in grams" min="0.1" step="0.1" onchange="updateTotalAmount()">
                </div>
                <div class="form-group">
                    <label class="form-label">Total Amount</label>
                    <div class="form-input" id="totalAmount">â‚¹0</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Payment Method</label>
                    <select class="form-input" id="paymentMethod">
                        <option value="UPI">UPI</option>
                        <option value="CARD">Credit/Debit Card</option>
                        <option value="NET_BANKING">Net Banking</option>
                    </select>
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button class="btn btn-primary" onclick="confirmTrade()">Confirm Trade</button>
                    <button class="btn" onclick="closeTradeModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Redemption Modal -->
    <div id="redemptionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Physical Redemption</h2>
                <span class="close" onclick="closeRedemptionModal()">&times;</span>
            </div>
            <div class="redemption-form">
                <p style="margin-bottom: 1.5rem; color: var(--text-secondary);">
                    Redeem your digital tokens for physical precious metals. Minimum redemption: 10g Gold, 100g Silver, 5g Platinum.
                </p>
                <div class="form-group">
                    <label class="form-label">Asset Type</label>
                    <select class="form-input" id="redemptionAssetSelect">
                        <option value="GOLD">Gold (Minimum: 10g)</option>
                        <option value="SILVER">Silver (Minimum: 100g)</option>
                        <option value="PLATINUM">Platinum (Minimum: 5g)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Quantity (grams)</label>
                    <input type="number" class="form-input" id="redemptionQuantity" placeholder="Enter quantity to redeem" min="1" step="0.1">
                </div>
                <div class="form-group">
                    <label class="form-label">Delivery Address</label>
                    <textarea class="form-input" id="deliveryAddress" rows="3" placeholder="Enter your complete delivery address"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Redemption Fee</label>
                    <div class="form-input" id="redemptionFee">â‚¹500 + 1% of total value</div>
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                    <button class="btn btn-success" onclick="confirmRedemption()">Request Redemption</button>
                    <button class="btn" onclick="closeRedemptionModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/material-ui/4.12.4/umd/material-ui.min.js" integrity="sha512-6xG2x2o5x5n5m5WcF5o7Y5l5N8x5t5v5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t5t" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Global variables
        let currentTenant = null;
        let authToken = null;
        let portfolioData = {
            gold: { balance: 0, value: 0, change: 0 },
            silver: { balance: 0, value: 0, change: 0 },
            platinum: { balance: 0, value: 0, change: 0 }
        };

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        async function initializeApp() {
            try {
                // Load tenant configuration
                await loadTenantConfig();
                
                // Load user data
                await loadUserData();
                
                // Load portfolio data
                await loadPortfolioData();
                
                // Load market prices
                await loadMarketPrices();
                
                // Set up navigation
                setupNavigation();
                
                // Show success message
                showAlert('Welcome to your portfolio!', 'success');
                
            } catch (error) {
                console.error('Failed to initialize app:', error);
                showAlert('Failed to load portfolio. Please refresh the page.', 'error');
            }
        }

        async function loadTenantConfig() {
            try {
                const response = await fetch('/api/v1/tenant/config', {
                    headers: {
                        'X-Tenant-Id': getTenantId(),
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to load tenant config');
                }

                const config = await response.json();
                currentTenant = config;
                
                // Apply branding
                applyBranding(config.brand);
                
                // Update UI
                document.getElementById('companyName').textContent = config.companyName;
                document.getElementById('pageTitle').textContent = `My Portfolio - ${config.companyName}`;
                document.getElementById('welcomeTitle').textContent = `Welcome back!`;
                document.getElementById('welcomeSubtitle').textContent = `Manage your ${config.companyName} precious metals portfolio`;
                
            } catch (error) {
                console.error('Error loading tenant config:', error);
                applyDefaultBranding();
            }
        }

        function applyBranding(brandConfig) {
            if (!brandConfig) return;
            
            const root = document.documentElement;
            
            // Apply colors
            if (brandConfig.primaryColor) {
                root.style.setProperty('--primary-color', brandConfig.primaryColor);
            }
            if (brandConfig.secondaryColor) {
                root.style.setProperty('--secondary-color', brandConfig.secondaryColor);
            }
            if (brandConfig.accentColor) {
                root.style.setProperty('--accent-color', brandConfig.accentColor);
            }
            
            // Apply logo
            if (brandConfig.logoUrl) {
                const logo = document.getElementById('companyLogo');
                logo.src = brandConfig.logoUrl;
                logo.style.display = 'block';
            }
        }

        function applyDefaultBranding() {
            const root = document.documentElement;
            root.style.setProperty('--primary-color', '#007AFF');
            root.style.setProperty('--secondary-color', '#5856D6');
            root.style.setProperty('--accent-color', '#BF953F');
        }

        async function loadUserData() {
            try {
                // In a real app, this would fetch user data from API
                // For demo, we'll use sample data
                const userData = {
                    name: 'Raj Kumar',
                    initials: 'RK',
                    totalBalance: 156700,
                    notifications: 3
                };
                
                document.getElementById('userAvatar').textContent = userData.initials;
                document.getElementById('totalBalance').textContent = formatCurrency(userData.totalBalance);
                document.getElementById('notificationBadge').textContent = userData.notifications;
                
            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }

        async function loadPortfolioData() {
            try {
                // In a real app, this would fetch from API
                // For demo, we'll use sample data
                portfolioData = {
                    gold: { balance: 2.5, value: 15625, change: 2.5 },
                    silver: { balance: 500, value: 28500, change: 1.2 },
                    platinum: { balance: 100, value: 123000, change: 0.8 }
                };
                
                updatePortfolioDisplay();
                
            } catch (error) {
                console.error('Error loading portfolio data:', error);
            }
        }

        function updatePortfolioDisplay() {
            // Update Gold
            document.getElementById('goldBalance').textContent = `${portfolioData.gold.balance}g`;
            document.getElementById('goldValue').textContent = formatCurrency(portfolioData.gold.value);
            document.getElementById('goldChange').textContent = `+${portfolioData.gold.change}%`;
            
            // Update Silver
            document.getElementById('silverBalance').textContent = `${portfolioData.silver.balance}g`;
            document.getElementById('silverValue').textContent = formatCurrency(portfolioData.silver.value);
            document.getElementById('silverChange').textContent = `+${portfolioData.silver.change}%`;
            
            // Update Platinum
            document.getElementById('platinumBalance').textContent = `${portfolioData.platinum.balance}g`;
            document.getElementById('platinumValue').textContent = formatCurrency(portfolioData.platinum.value);
            document.getElementById('platinumChange').textContent = `+${portfolioData.platinum.change}%`;
        }

        async function loadMarketPrices() {
            try {
                // In a real app, this would fetch live market data
                // For demo, we'll use static prices
                const prices = {
                    gold: { price: 6250, change: 1.2 },
                    silver: { price: 57, change: 0.8 },
                    platinum: { price: 1230, change: 0.5 }
                };
                
                document.getElementById('goldPrice').textContent = `â‚¹${prices.gold.price}/g`;
                document.getElementById('goldChangePercent').textContent = `+${prices.gold.change}%`;
                document.getElementById('goldChangePercent').className = 'price-change positive';
                
                document.getElementById('silverPrice').textContent = `â‚¹${prices.silver.price}/g`;
                document.getElementById('silverChangePercent').textContent = `+${prices.silver.change}%`;
                document.getElementById('silverChangePercent').className = 'price-change positive';
                
                document.getElementById('platinumPrice').textContent = `â‚¹${prices.platinum.price}/g`;
                document.getElementById('platinumChangePercent').textContent = `+${prices.platinum.change}%`;
                document.getElementById('platinumChangePercent').className = 'price-change positive';
                
                document.getElementById('priceUpdateTime').textContent = '2 mins ago';
                
            } catch (error) {
                console.error('Error loading market prices:', error);
            }
        }

        function setupNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Remove active class from all links
                    navLinks.forEach(l => l.classList.remove('active'));
                    
                    // Add active class to clicked link
                    this.classList.add('active');
                    
                    // Get page name
                    const page = this.getAttribute('data-page');
                    
                    // Load page content
                    loadPage(page);
                });
            });
        }

        function loadPage(pageName) {
            const welcomeTitle = document.querySelector('.welcome-title');
            const welcomeSubtitle = document.querySelector('.welcome-subtitle');
            
            // Update page title
            const titles = {
                'dashboard': ['Welcome back!', 'Here\'s your precious metals portfolio overview'],
                'portfolio': ['My Portfolio', 'View and manage your token holdings'],
                'buy': ['Buy Tokens', 'Purchase gold, silver, or platinum tokens'],
                'sell': ['Sell Tokens', 'Sell your tokens for instant cash'],
                'transactions': ['Transaction History', 'View all your past transactions'],
                'redemption': ['Physical Redemption', 'Convert tokens to physical metals'],
                'security': ['Security Center', 'Manage your account security settings'],
                'support': ['Help & Support', 'Get help and support'],
                'profile': ['Profile Settings', 'Manage your account settings']
            };
            
            const [title, subtitle] = titles[pageName] || titles['dashboard'];
            welcomeTitle.textContent = title;
            welcomeSubtitle.textContent = subtitle;
        }

        // Modal functions
        function openTradeModal(type) {
            const modal = document.getElementById('tradeModal');
            const title = document.getElementById('tradeModalTitle');
            
            title.textContent = type === 'buy' ? 'Buy Tokens' : 'Sell Tokens';
            modal.style.display = 'block';
        }

        function closeTradeModal() {
            document.getElementById('tradeModal').style.display = 'none';
        }

        function openRedemptionModal() {
            document.getElementById('redemptionModal').style.display = 'block';
        }

        function closeRedemptionModal() {
            document.getElementById('redemptionModal').style.display = 'none';
        }

        function updateTotalAmount() {
            const quantity = parseFloat(document.getElementById('quantityInput').value) || 0;
            const assetType = document.getElementById('assetTypeSelect').value;
            
            let price = 0;
            switch(assetType) {
                case 'GOLD': price = 6250; break;
                case 'SILVER': price = 57; break;
                case 'PLATINUM': price = 1230; break;
            }
            
            const total = quantity * price;
            document.getElementById('totalAmount').textContent = formatCurrency(total);
        }

        function confirmTrade() {
            const assetType = document.getElementById('assetTypeSelect').value;
            const quantity = document.getElementById('quantityInput').value;
            const totalAmount = document.getElementById('totalAmount').textContent;
            
            if (!quantity || quantity <= 0) {
                showAlert('Please enter a valid quantity', 'error');
                return;
            }
            
            // In a real app, this would make an API call
            showAlert(`Trade confirmed: ${quantity}g ${assetType} for ${totalAmount}`, 'success');
            closeTradeModal();
            
            // Reset form
            document.getElementById('quantityInput').value = '';
            document.getElementById('totalAmount').textContent = 'â‚¹0';
        }

        function confirmRedemption() {
            const assetType = document.getElementById('redemptionAssetSelect').value;
            const quantity = document.getElementById('redemptionQuantity').value;
            const address = document.getElementById('deliveryAddress').value;
            
            if (!quantity || quantity <= 0) {
                showAlert('Please enter a valid quantity', 'error');
                return;
            }
            
            if (!address.trim()) {
                showAlert('Please enter delivery address', 'error');
                return;
            }
            
            // In a real app, this would make an API call
            showAlert(`Redemption request submitted: ${quantity}g ${assetType}`, 'success');
            closeRedemptionModal();
            
            // Reset form
            document.getElementById('redemptionQuantity').value = '';
            document.getElementById('deliveryAddress').value = '';
        }

        function downloadCertificate() {
            // In a real app, this would generate and download certificate
            showAlert('Certificate download started', 'success');
        }

        function toggleNotifications() {
            // In a real app, this would show notifications panel
            showAlert('Notifications panel would open here', 'info');
        }

        function showUserMenu() {
            // In a real app, this would show user dropdown menu
            const menu = confirm('Do you want to logout?');
            if (menu) {
                // Handle logout
                showAlert('Logged out successfully', 'success');
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            }
        }

        // Utility functions
        function showAlert(message, type = 'info') {
            const alertContainer = document.getElementById('alertContainer');
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            alertContainer.appendChild(alertDiv);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        function formatCurrency(amount) {
            return 'â‚¹' + new Intl.NumberFormat('en-IN').format(amount);
        }

        function getTenantId() {
            return localStorage.getItem('tenant_id') || 'demo-tenant-id';
        }

        // Handle modal clicks
        window.onclick = function(event) {
            const tradeModal = document.getElementById('tradeModal');
            const redemptionModal = document.getElementById('redemptionModal');
            
            if (event.target === tradeModal) {
                closeTradeModal();
            } else if (event.target === redemptionModal) {
                closeRedemptionModal();
            }
        }

        // Demo data loading
        setTimeout(() => {
            // Demo data for testing
            const demoActivities = [
                {
                    description: `Bought 2.5g Gold BGT`,
                    details: `Transaction #TXN789123 | 2 hours ago`,
                    amount: 'â‚¹15,625'
                },
                {
                    description: `Sold 100g Silver BST`,
                    details: `Transaction #TXN789122 | 1 day ago`,
                    amount: 'â‚¹5,700'
                },
                {
                    description: `Portfolio increased by +1.8%`,
                    details: `Market movement | 2 days ago`,
                    amount: '+â‚¹4,250'
                }
            ];

            const activityList = document.getElementById('activityList');
            activityList.innerHTML = demoActivities.map(activity => `
                <div class="activity-item">
                    <div class="activity-content">
                        <div class="activity-description">${activity.description}</div>
                        <div class="activity-details">${activity.details}</div>
                    </div>
                    <div class="activity-amount">${activity.amount}</div>
                </div>
            `).join('');
        }, 1000);
    </script>
</body>
</html>